

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>warno_event_manager &mdash; WARNO 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="WARNO 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="Event Manager" href="index.html"/>
        <link rel="next" title="Indices and tables" href="../../indices.html"/>
        <link rel="prev" title="Event Manager" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> WARNO</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../WarnoIntroduction/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#fabric">Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#design">Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../WarnoIntroduction/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#before-you-start">Before you Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#start-up-configuration">Start Up Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#nfs-permissions">NFS Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#multiple-vm-s-one-one-machine">Multiple VM&#8217;s one one machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#start-up">Start Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#demo-data">Demo Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#user-portal-access">User Portal Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#valid-columns-for-graphs">Valid Columns for graphs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../WarnoIntroduction/tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Latest Release</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../WarnoConfig/index.html">WARNO Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Agent/index.html">Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UserPortal/index.html">User Portal</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Event Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">Indices and tables</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">WARNO</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Latest Release</a> &raquo;</li>
      
          <li><a href="index.html">Event Manager</a> &raquo;</li>
      
    <li><code class="docutils literal"><span class="pre">warno_event_manager</span></code></li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/WarnoVagrant/EventManager/warno_event_manager.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="module-warno_event_manager">
<span id="warno-event-manager"></span><h1><a class="reference internal" href="#module-warno_event_manager" title="warno_event_manager"><code class="xref py py-mod docutils literal"><span class="pre">warno_event_manager</span></code></a><a class="headerlink" href="#module-warno_event_manager" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="warno_event_manager.ReverseProxied">
<em class="property">class </em><code class="descclassname">warno_event_manager.</code><code class="descname">ReverseProxied</code><span class="sig-paren">(</span><em>given_app</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.ReverseProxied" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wrap the application in this middleware and configure the
front-end server to add these headers, to let you quietly bind
this to a URL other than / and to an HTTP scheme that is
different than what is used locally.</p>
<p>In nginx:
location /myprefix {
proxy_pass <a class="reference external" href="http://192.168.0.1:5001">http://192.168.0.1:5001</a>;
proxy_set_header Host $host;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Scheme $scheme;
proxy_set_header X-Script-Name /myprefix;
}</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>given_app: the WSGI application</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.clear_and_populate_redis">
<code class="descclassname">warno_event_manager.</code><code class="descname">clear_and_populate_redis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.clear_and_populate_redis" title="Permalink to this definition">¶</a></dt>
<dd><p>Completely wipes the Redis database, then loads recent entries and event codes from the main database into Redis.</p>
<p>This is mostly only called after loading in test data, or loading a database file.</p>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.event">
<code class="descclassname">warno_event_manager.</code><code class="descname">event</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Event comes as a web request with a JSON packet.  The JSON is loaded into dictionary, and the
event code is extracted. Dependent on the event code, different functions are called.</p>
<p>If it is part of a predefined set of special event codes, calls a new function to handle it, depending on the
event code.  Passes the message in to the call, then returns the return of whichever sub-function was called.</p>
<p>If it is not a special case, it extracts the information from the packet and saves the event to the database.
If the &#8216;is_central&#8217; flag is not set, it then forwards the packet on to the &#8216;cf_url&#8217;
(both specified in <em>config.yml</em>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The original message packet if a sub-function was not called, the sub-function&#8217;s return if it was called.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.event_manager_home">
<code class="descclassname">warno_event_manager.</code><code class="descname">event_manager_home</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.event_manager_home" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates very basic information (cpu usage, site name) and passes the information to a template, serving as
a home page for the event manager.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">index.html: HTML document</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.get_event_code">
<code class="descclassname">warno_event_manager.</code><code class="descname">get_event_code</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.get_event_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches the database for any event codes where the description matches &#8216;msg_struct[&#8216;description&#8217;]&#8217;.  If the
&#8216;is_central&#8217; flag is set and there is no event code, creates the event code in the database and returns it. If the
&#8216;is_central&#8217; flag is not set, it then forwards the packet on to the &#8216;cf_url&#8217; (both specified in <em>config.yml</em>) and
returns whatever the central facility determines the event code is.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON</strong></p>
<blockquote>
<div><p>JSON message structure, expected format: {event_code: <em>code</em>, data: {description: <em>description</em>}}</p>
</div></blockquote>
<p><strong>msg_struct: dictionary</strong></p>
<blockquote>
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The event code determined by the function, in the form of a string structured as</p>
<p class="last">&#8216;{&#8220;event_code&#8221;: <em>event code</em>, &#8220;data&#8221;: {&#8220;description&#8221;: <em>description</em>}}&#8217;.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.get_instrument_id">
<code class="descclassname">warno_event_manager.</code><code class="descname">get_instrument_id</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.get_instrument_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches the database for any instruments where the instrument abbreviation matches
&#8216;msg_struct[&#8216;instrument&#8217;]&#8217;.  If the &#8216;is_central&#8217; flag is set and there is no instrument,
returns a -1 to indicate nothing was found, but if it was found, returns the instrument&#8217;s
information to be saved. If the &#8216;is_central&#8217; flag is not set, it then forwards the
packet on to the &#8216;cf_url&#8217; (both specified in <em>config.yml</em>) and returns whatever the central
facility determines the instrument id is, saving the returned site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON</strong></p>
<blockquote>
<div><p>JSON message structure, expected format: {Event_Code: <em>code</em>, Data: <em>instrument abbreviation</em>}</p>
</div></blockquote>
<p><strong>msg_struct: dictionary</strong></p>
<blockquote>
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The instrument id or information determined by the function.</p>
<p>Returned in the form of a string structured as</p>
<p>{&#8220;event_code&#8221;: <em>integer event code</em>, &#8220;data&#8221;: {&#8220;instrument_id&#8221;: <em>integer instrument id</em>, &#8220;site_id&#8221;:</p>
<p><em>integer site id instrument is at</em>, &#8220;name_short&#8221;: <em>string instrument abbreviation</em>, &#8220;name_long&#8221;:</p>
<p><em>string full instrument name</em>, &#8220;type&#8221;: <em>string type of instrument</em>, &#8220;vendor&#8221;: <em>string instrument&#8217;s vendor</em>,</p>
<p>&#8220;description&#8221;: <em>string description of instrument</em> }}.</p>
<p class="last">If no instrument was found, the instrument id is passed as -1.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.get_site_id">
<code class="descclassname">warno_event_manager.</code><code class="descname">get_site_id</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.get_site_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches the database for any sites where the site abbreviation matches &#8216;msg_struct[&#8216;site&#8217;]&#8217;.  If the
&#8216;is_central&#8217; flag is set and there is no site, returns a -1 to indicate nothing was found, but if it was found,
returns the site&#8217;s information to be saved. If the &#8216;is_central&#8217; flag is not set, it then forwards the packet on
to the &#8216;cf_url&#8217; (both specified in <em>config.yml</em>) and returns whatever the central facility determines the site
id is, saving the returned site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON</strong></p>
<blockquote>
<div><p>JSON message structure, expected format: {event_code: <em>code</em>, data: {site: <em>site abbreviation</em>}}</p>
</div></blockquote>
<p><strong>msg_struct: dictionary</strong></p>
<blockquote>
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The site id or information determined by the function.</p>
<p>Returned in the form of a string structured as</p>
<p>{&#8220;event_code&#8221;: <em>integer event code</em>, &#8220;data&#8221;: {&#8220;site_id&#8221;: <em>integer site id</em>, &#8220;latitude&#8221;:</p>
<p><em>float latitude coordinate</em>, &#8220;longitude&#8221;: <em>float longitude coordinate</em>, &#8220;name_short&#8221;: <em>string site abbreviation</em>,</p>
<p>&#8220;name_long&#8221;: <em>string full site name</em>, &#8220;facility&#8221;: <em>string facility name</em>,</p>
<p>&#8220;mobile&#8221;: <em>boolean true if is a mobile site</em>, &#8220;Location Name&#8221;: <em>string location name</em>}}.</p>
<p class="last">If no site was found, the site id is passed as -1.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.initialize_database">
<code class="descclassname">warno_event_manager.</code><code class="descname">initialize_database</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.initialize_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the database.</p>
<p>If the database is specified in config.yml as a &#8216;test_db&#8217;
the database is wiped when at the beginning to ensure a clean load.  If it is not a test
database, a utility function is called to attempt to load in a postgresql database dumpfile
if it exists.  First, the tables are initialized, and then if no basic database entries
exist (users, sites, event codes), they are created.  Then, if it is designated a test database,
any table that does not contain any entries will be filled with demo data.</p>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.new_event">
<code class="descclassname">warno_event_manager.</code><code class="descname">new_event</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.new_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a new event</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg</strong></p>
<p class="last"><strong>msg_struct</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_instrument_data_reference">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_instrument_data_reference</code><span class="sig-paren">(</span><em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_instrument_data_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks to see if there is already an instrument data reference for this event code, and if there isn&#8217;t, creates
one. Instrument data references are used to allow the servers to track which events are pertinent to a particular
instrument (some events are for all instruments, some only for specific instrument types).  If an instrument data
reference is to be added, this function also determines whether the reference is &#8216;special&#8217; or not.  If there is an
entire special table devoted to the event (where &#8216;description&#8217; is the table name), then it is classified as
&#8216;special&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg_struct: dictionary</strong></p>
<blockquote class="last">
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_instrument_log">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_instrument_log</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_instrument_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts the information given in &#8216;msg_struct&#8217; into the database &#8216;instrument_logs&#8217; table, with all of the values
being mapped into columns for the database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON</strong></p>
<blockquote>
<div><p>JSON message structure, expected format:
{event_code: <em>code</em>, data: {time: <em>ISO DateTime</em>, author_id: <em>Integer</em>, instrument_id: <em>Integer</em>,
status: <em>Integer Status Code</em>, contents: <em>Log Message</em>, supporting_images: <em>Image</em>}}</p>
</div></blockquote>
<p><strong>msg_struct: dictionary</strong></p>
<blockquote class="last">
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_json_db_data">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_json_db_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_json_db_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves database tables containing data information, such as &#8216;events_with_value&#8217; or &#8216;prosensing_paf&#8217; events, to a
json file.  &#8216;num_entries&#8217; for each table specifies how many data rows are in the file for the table, making
iterative parsing much easier.</p>
<p>Example File (indentation unnecessary):</p>
<dl class="docutils">
<dt>[</dt>
<dd><dl class="first docutils">
<dt>{</dt>
<dd><dl class="first docutils">
<dt>&#8220;definition&#8221;:</dt>
<dd><p class="first">{</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;table_name&#8221;:</dt>
<dd><em>database table name</em>,</dd>
<dt>&#8220;columns&#8221;:</dt>
<dd>[(column_name_1, column_type_1), ..., (column_name_N, column_type_N)]</dd>
</dl>
</div></blockquote>
<p class="last">}</p>
</dd>
<dt>&#8220;data&#8221;:</dt>
<dd>[
[val_1, val_2, ..., val_N],
[val_1, val_2, ..., val_N],
...,
[val_1, val_2, ..., val_N] ]</dd>
</dl>
<p>},</p>
<p>{ <em>table_2</em> },</p>
<p>...,</p>
<p class="last">{ <em>table_N</em> }</p>
</dd>
</dl>
<p class="last">]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_json_db_info">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_json_db_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_json_db_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves database tables containing more permanent information, such as sites or instruments, to a json file.
File name has the format &#8216;db_info_*day*_*month*_*year*&#8217;, where the date corresponds to the date the function was run
because it shows the current status of the database.</p>
<p>Example File (indentation unnecessary):</p>
<dl class="docutils">
<dt>[</dt>
<dd><dl class="first docutils">
<dt>{</dt>
<dd><dl class="first docutils">
<dt>&#8220;definition&#8221;:</dt>
<dd><p class="first">{</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;table_name&#8221;:</dt>
<dd><em>database table name</em>,</dd>
<dt>&#8220;columns&#8221;:</dt>
<dd>[(column_name_1, column_type_1), ..., (column_name_N, column_type_N)]</dd>
</dl>
</div></blockquote>
<p class="last">}</p>
</dd>
<dt>&#8220;data&#8221;:</dt>
<dd>[
[val_1, val_2, ..., val_N],
[val_1, val_2, ..., val_N],
...,
[val_1, val_2, ..., val_N] ]</dd>
</dl>
<p>},</p>
<p>{ <em>table_2</em> },</p>
<p>...,</p>
<p class="last">{ <em>table_N</em> }</p>
</dd>
</dl>
<p class="last">]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_misc_event">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_misc_event</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_misc_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a MISC event message.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON object</strong></p>
<blockquote>
<div><p>JSON object representing the message</p>
</div></blockquote>
<p><strong>msg_struct: dict</strong></p>
<blockquote class="last">
<div><p>Dictionary representation of message</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_pulse_capture">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_pulse_capture</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_pulse_capture" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts the information given in &#8216;msg_struct&#8217; into the database &#8216;pulse_captures&#8217; table, with all of the values
being mapped into columns for the database.  If the &#8216;is_central&#8217; flag is not set, it then forwards the packet on
to the &#8216;cf_url&#8217; (both specified in <em>config.yml</em>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON</strong></p>
<blockquote>
<div><p>JSON message structure, expected format:         {event_code: <em>code</em>, data: {time: <em>ISO DateTime</em>, site_id: <em>Integer</em>, instrument_id: <em>Integer</em>,         values: <em>Array of Floats</em>}}</p>
</div></blockquote>
<p><strong>msg_struct: dictionary</strong></p>
<blockquote class="last">
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.save_special_event">
<code class="descclassname">warno_event_manager.</code><code class="descname">save_special_event</code><span class="sig-paren">(</span><em>msg</em>, <em>msg_struct</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.save_special_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts the information given in &#8216;msg_struct&#8217; into the database, with all of the values being mapped into columns
for the database.  If the &#8216;is_central&#8217; flag is not set, it then forwards the packet on to the &#8216;cf_url&#8217;
(both specified in <em>config.yml</em>).  Uses the event code from the message to determine which table to save to.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>msg: JSON</strong></p>
<blockquote>
<div><p>JSON message structure, expected format:
{event_code: <em>code</em>, data: {time: <em>ISO DateTime</em>, site_id: <em>Integer</em>, instrument_id: <em>Integer</em>,
values: <em>Dictionary of database column names mapped to their values</em>}}</p>
</div></blockquote>
<p><strong>msg_struct: dictionary</strong></p>
<blockquote class="last">
<div><p>Decoded version of msg, converted to python dictionary.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.trigger_migration_downgrade">
<code class="descclassname">warno_event_manager.</code><code class="descname">trigger_migration_downgrade</code><span class="sig-paren">(</span><em>migration_path</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.trigger_migration_downgrade" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional function to trigger a database migration downgrade 1 version.
Causes program to exit!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>migration_path</strong> : str</p>
<blockquote class="last">
<div><p>Migration Path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="warno_event_manager.trigger_migration_migrate">
<code class="descclassname">warno_event_manager.</code><code class="descname">trigger_migration_migrate</code><span class="sig-paren">(</span><em>migration_path</em><span class="sig-paren">)</span><a class="headerlink" href="#warno_event_manager.trigger_migration_migrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional function to trigger generating a database migration.
Causes program to exit!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>migration_path: str</strong></p>
<blockquote class="last">
<div><p>Migration Path</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../indices.html" class="btn btn-neutral float-right" title="Indices and tables">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Event Manager"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Joseph Hardin.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>