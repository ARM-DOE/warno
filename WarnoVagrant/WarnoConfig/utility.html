

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>WarnoConfig.utility &mdash; WARNO 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="WARNO 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="WARNO Config" href="index.html"/>
        <link rel="next" title="Agent" href="../Agent/index.html"/>
        <link rel="prev" title="WarnoConfig.config" href="config.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> WARNO</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../WarnoIntroduction/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#fabric">Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/index.html#design">Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../WarnoIntroduction/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#before-you-start">Before you Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#start-up-configuration">Start Up Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#nfs-permissions">NFS Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#multiple-vm-s-one-one-machine">Multiple VM&#8217;s one one machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#start-up">Start Up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#demo-data">Demo Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#user-portal-access">User Portal Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WarnoIntroduction/installation.html#valid-columns-for-graphs">Valid Columns for graphs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../WarnoIntroduction/tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Latest Release</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">WARNO Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Agent/index.html">Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UserPortal/index.html">User Portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../EventManager/index.html">Event Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">Indices and tables</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">WARNO</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Latest Release</a> &raquo;</li>
      
          <li><a href="index.html">WARNO Config</a> &raquo;</li>
      
    <li><code class="docutils literal"><span class="pre">WarnoConfig.utility</span></code></li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/WarnoVagrant/WarnoConfig/utility.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="warnoconfig-utility">
<h1><a class="reference internal" href="#module-WarnoConfig.utility" title="WarnoConfig.utility"><code class="xref py py-mod docutils literal"><span class="pre">WarnoConfig.utility</span></code></a><a class="headerlink" href="#warnoconfig-utility" title="Permalink to this headline">¶</a></h1>
<p>This module contains the various utility functions used between other modules.</p>
<div class="section" id="module-WarnoConfig.utility">
<span id="module-contents"></span><h2>Module Contents<a class="headerlink" href="#module-WarnoConfig.utility" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="WarnoConfig.utility.connect_db">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">connect_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.connect_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to the default WARNO database server.
Returns
&#8212;&#8212;-
psycopg2 connection object for the WARNO database server.</p>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.create_table_from_file">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">create_table_from_file</code><span class="sig-paren">(</span><em>filename</em>, <em>curr</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.create_table_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in a data file written in postgresql and executes the contents in the database</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: string</strong></p>
<blockquote>
<div><p>Name of the file to read from.</p>
</div></blockquote>
<p class="last"><strong>curr: database cursor</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.drop_table">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">drop_table</code><span class="sig-paren">(</span><em>table_name</em>, <em>curr</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.drop_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Drops the database table with the name &#8216;table_name&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>table_name: string</strong></p>
<blockquote>
<div><p>Name of table to drop.</p>
</div></blockquote>
<p class="last"><strong>curr: database cursor</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.dump_table_to_csv">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">dump_table_to_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>table</em>, <em>server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.dump_table_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Dumps the database table named &#8216;table&#8217; as a comma separated file into &#8216;filename&#8217;,
from database server &#8216;server&#8217; if supplied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: string</strong></p>
<blockquote>
<div><p>Name of the file to be written to.</p>
</div></blockquote>
<p><strong>table: string</strong></p>
<blockquote>
<div><p>Name of the database table to dump into a file.</p>
</div></blockquote>
<p><strong>server: sqlalchemy engine, optional</strong></p>
<blockquote class="last">
<div><p>A sqlalchemy engine for whichever database server the data will be read from,
defaults to the default WARNO server.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.initialize_database">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">initialize_database</code><span class="sig-paren">(</span><em>curr</em>, <em>path='schema/'</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.initialize_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the database with the schemas in the &#8220;path&#8221; directory. Current tables to be created are:</p>
<ul class="simple">
<li>users</li>
<li>sites</li>
<li>instruments</li>
<li>instrument_logs</li>
<li>usage</li>
<li>prosensing_paf</li>
<li>event_codes</li>
<li>events_with_text</li>
<li>events_with_value</li>
<li>pulse_captures</li>
<li>table_references</li>
<li>instrument_data_references</li>
</ul>
<p>If the table does not already exist, creates it from the file &#8216;path/table_name.schema&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>curr: database cursor</strong></p>
<p><strong>path: string, optional</strong></p>
<blockquote class="last">
<div><p>Path that the schema files are expected to be in, defaults to &#8220;schema/&#8221;.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.is_number">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">is_number</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.is_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a string is a valid floating point number.</p>
<p>Attempts to convert a string to a floating point number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>s: string</strong></p>
<blockquote>
<div><p>The string to be checked.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True: Boolean</p>
<blockquote>
<div><p>Returns True if the conversion works successfully.</p>
</div></blockquote>
<p>False: Boolean</p>
<blockquote class="last">
<div><p>Returns False if the conversion throws a &#8216;ValueError&#8217; Exception.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.load_data_into_table">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">load_data_into_table</code><span class="sig-paren">(</span><em>filename</em>, <em>table</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.load_data_into_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a comma separated (no spaces) file &#8216;filename&#8217; into the database table &#8216;table&#8217;.</p>
<p>Example data file &#8220;table_name.schema&#8221;:</p>
<div class="line-block">
<div class="line">column_name_1,column_name_2</div>
<div class="line">row_1_column_1_value,row_1_column_2_value</div>
<div class="line">row_2_column_1_value,row_2_column_2_value</div>
<div class="line">...</div>
<div class="line">(etc.)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: string</strong></p>
<blockquote>
<div><p>Name of the file to load into the table.</p>
</div></blockquote>
<p><strong>table: string</strong></p>
<blockquote class="last">
<div><p>Name of the table to load the file into.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.load_dumpfile">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">load_dumpfile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.load_dumpfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the &#8216;db_load&#8217; script in a subprocess to load a postgresql database dump into the database, and waits for the
subprocess to finish.</p>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.load_json_data">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">load_json_data</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.load_json_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load json data from &#8216;filename&#8217; into the database. Each file should have a list of &#8216;definition&#8217;/&#8217;data&#8217; pairs, one
for each database table to have data loaded in.  Each definition should at least have: &#8216;table_name&#8217;, &#8216;num_entries&#8217;,
and &#8216;columns&#8217;.</p>
<p>Example File (indentation unnecessary):</p>
<dl class="docutils">
<dt>[</dt>
<dd><dl class="first docutils">
<dt>{</dt>
<dd><dl class="first docutils">
<dt>&#8220;definition&#8221;:</dt>
<dd><p class="first">{</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;table_name&#8221;:</dt>
<dd><em>database table name</em>,</dd>
<dt>&#8220;columns&#8221;:</dt>
<dd>[(column_name_1, column_type_1), ..., (column_name_N, column_type_N)]</dd>
</dl>
</div></blockquote>
<p class="last">}</p>
</dd>
<dt>&#8220;data&#8221;:</dt>
<dd>[
[val_1, val_2, ..., val_N],
[val_1, val_2, ..., val_N],
...,
[val_1, val_2, ..., val_N] ]</dd>
</dl>
<p>},</p>
<p>{ <em>table_2</em> },</p>
<p>...,</p>
<p class="last">{ <em>table_N</em> }</p>
</dd>
</dl>
<p class="last">]</p>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename: string</strong></p>
<blockquote class="last">
<div><p>Name of the file to be loaded into the database.  Must be proper JSON.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.reset_db_keys">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">reset_db_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.reset_db_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the &#8216;db_sequence_reset&#8217; script in a subprocess to reset the postgres primary keys, and waits for the
subprocess to finish. Without this reset, inserts that insert at a certain ID do not properly update the keys, so
the next inserts will sometimes attempt to insert on the same id, which fails.  This approach may lead to some gaps
in ids, but it will be more fault tolerant than it is currently.</p>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.save_rows_to_table">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">save_rows_to_table</code><span class="sig-paren">(</span><em>table</em>, <em>columns</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.save_rows_to_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the list of database values in &#8216;data&#8217; into the &#8216;columns&#8217; for the specified &#8216;table&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>table: string</strong></p>
<blockquote>
<div><p>Name of the database table to save the entries into.</p>
</div></blockquote>
<p><strong>columns: list of strings</strong></p>
<blockquote>
<div><p>List of column names to save the database entries into.  Length of list should match the length of each element
of &#8216;data&#8217;, as each value in a &#8216;data&#8217; row maps to the corresponding column in &#8216;columns&#8217;.</p>
</div></blockquote>
<p><strong>data: list of value lists</strong></p>
<blockquote class="last">
<div><p>&#8216;data&#8217; is effectively a list of database table rows, with each row having the same number of elements as
&#8216;columns&#8217;, and each element being the proper type for the column (not enforced here).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.signal_handler">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">signal_handler</code><span class="sig-paren">(</span><em>signal</em>, <em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.signal_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up Ctrl-C Handling</p>
<p>This function sets up signal interrupt catching, primarily to handle Ctrl-C.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal: signal</strong></p>
<blockquote>
<div><p>Signal to catch.</p>
</div></blockquote>
<p><strong>frame: frame</strong></p>
<blockquote class="last">
<div><p>frame</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.status_code_to_text">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">status_code_to_text</code><span class="sig-paren">(</span><em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.status_code_to_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an instrument&#8217;s status code to its text equivalent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>status: integer</strong></p>
<blockquote>
<div><p>The status code to be converted.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">status_text: string</p>
<blockquote class="last">
<div><p>Returns a string representation of the status code from the status_text dictionary.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="WarnoConfig.utility.table_exists">
<code class="descclassname">WarnoConfig.utility.</code><code class="descname">table_exists</code><span class="sig-paren">(</span><em>table_name</em>, <em>curr</em><span class="sig-paren">)</span><a class="headerlink" href="#WarnoConfig.utility.table_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a table with name &#8216;table_name&#8217; exists in the database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>table_name: string</strong></p>
<blockquote>
<div><p>Name of the postgresql table to be checked.</p>
</div></blockquote>
<p><strong>curr: database cursor</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">result: boolean</p>
<blockquote class="last">
<div><p>Returns True if the table exists, otherwise False.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Agent/index.html" class="btn btn-neutral float-right" title="Agent">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config.html" class="btn btn-neutral" title="WarnoConfig.config"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Joseph Hardin.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>